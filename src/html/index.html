<!DOCTYPE HTML>
<html lang="en" data-theme="dark">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>Humi</title>
    <meta name="description" content="A pure HTML example, without dependencies." />

    <link rel="stylesheet" href="pico.min.css" />
    <script>
        function sendMessage(messageType, value) {
            async function send(message) {
                try {
                    let results = await fetch("/set", {
                        method: "POST",
                        headers: { "Content-type": "application/json" },
                        body: message
                    });

                    if (results.status != 200) {
                        showInfoModal("Communication error");
                    }
                }
                catch (error) {
                    showInfoModal("Communication error");
                }
            }

            var clickedButton = event.target;
            clickedButton.disabled = true;

            let message = {
                "type": messageType,
                "value": value
            };

            send(JSON.stringify(message));
        }


        function closeModal(modalName) {
            const dialog = document.getElementById(modalName);
            dialog.close();
        }

    </script>
</head>

<body>

    <header class="container">
        <nav>
            <ul></ul>
            <ul>
                <li><strong>Humi</strong></li>
            </ul>
            <ul></ul>
        </nav>
    </header>

    <main class="container">
        <article>
            <header>Main</header>
            <div role="group">
                <button onclick="sendMessage('power', 1)">ON</button>
                <button onclick="sendMessage('power', 0)">OFF</button>
            </div>
            <div class="grid">
                <div role="group">
                    <input readonly type="text" name="text" value="Humidity:" aria-label="Text" />
                    <input readonly type="text" name="text" value="41%" aria-label="Text" />
                </div>
                <div role="group">
                    <input readonly type="text" name="text" value="Water container:" aria-label="Text" />
                    <input readonly type="text" name="text" value="empty" aria-invalid="true" aria-label="Text" />
                </div>
            </div>
        </article>
        <article>
            <header>Humidify dependent</header>
            <div role="group">
                <button disabled>40%</button>
                <button>45%</button>
                <button>50%</button>
                <button>55%</button>
            </div>
            <div role="group">
                <button>60%</button>
                <button>65%</button>
                <button>70%</button>
                <button>75%</button>
            </div>
        </article>
        <article>
            <header>Constant humidification</header>
            <div role="group">
                <button>Low</button>
                <button>Medium</button>
                <button>High</button>
                <button>Turbo</button>
            </div>
        </article>
    </main>
    <dialog id="infoModal">
        <article>
            <header>
                <h3>Sending data</h3>
            </header>
            <p id="infoModalText"></p>
            <footer>
                <button autofocus id="btnConfirmSensorRemoval" onclick="closeModal('infoModal')">Ok</button>
            </footer>
        </article>
    </dialog>
</body>

</html>